import nltk 
from nltk.stem import PorterStemmer, WordNetLemmatizer

print("Downloading NLTK data...")
nltk.download('wordnet')
nltk.download('omw-1.4')
print("Download complete.")

stemmer = PorterStemmer()
lemmatizer = WordNetLemmatizer()


PREFIXES = ["un", "re", "in", "dis", "pre", "post", "mis"]
SUFFIXES = ["s", "es", "ed", "ing", "er", "tion", "ness", "ment", "able", "ful", "less"]

def add_affix(root, prefix=None, suffix=None):
    """'ADD' function: Add prefix and/or suffix to root word."""
    return (prefix or "") + root + (suffix or "")

def delete_affix(word):
    """'DELETE' function: Remove prefix/suffix if present and return possible root forms."""
    results = []
    
    for p in PREFIXES:
        if word.startswith(p) and len(word) > len(p) + 2:
            results.append(word[len(p):]) # Get the root after the prefix

    for s in SUFFIXES:
        if word.endswith(s) and len(word) > len(s) + 2:
            results.append(word[:-len(s)]) # Get the root before the suffix

    if not results:
        results.append(word) 
        
    return list(set(results)) # Return unique roots found

def analyze_word(word):
    stem = stemmer.stem(word)
    lemma_n = lemmatizer.lemmatize(word, pos='n')
    lemma_v = lemmatizer.lemmatize(word, pos='v')

    roots = delete_affix(word)

    variations = []
    for r in roots:
        # Just add one prefix and one suffix to demo
        variations.append(add_affix(r, prefix="re"))
        variations.append(add_affix(r, suffix="ing"))

    return {
        "Word": word,
        "Stem (NLTK)": stem,
        "Lemma-Noun (NLTK)": lemma_n,
        "Lemma-Verb (NLTK)": lemma_v,
        "Roots (by Delete)": ", ".join(roots),
        "Generated (by Add)": ", ".join(set(variations))
    }

words = ["running", "unhappiness", "redo", "studies", "player"]

print("--- Morphological Analysis Results ---")

for w in words:
    result = analyze_word(w)
    
    print(f"\n--- Analysis for: '{result['Word']}' ---")
    print(f"  Stem (NLTK):        {result['Stem (NLTK)']}")
    print(f"  Lemma-Noun (NLTK):  {result['Lemma-Noun (NLTK)']}")
    print(f"  Lemma-Verb (NLTK):  {result['Lemma-Verb (NLTK)']}")
    print(f"  Roots (by Delete):  {result['Roots (by Delete)']}")
    print(f"  Generated (by Add): {result['Generated (by Add)']}")
